# 实验报告

## 第一次测试 - 1

代码不变的情况下：

| 数据量 | 字段长 |  Batch-Size |
| :----: | :----: | :----: |
| 20000  |   64   |64|



|        时间                | 模式 |
| :-------------------------------: | :-------------------------------: |
| `[3.4316 ms 3.9184 ms 4.5203 ms]` |non-batch|
| `[2.5076 ms 2.5772 ms 2.6529 ms]` |batch|

但是这只在 KeySize = 64 的时候存在，长于 64 的 Default 会导致这个优势荡然无存，都退化到3左右。

我们再运行一次：

| 数据量 | 字段长 | Batch-Size |
| :----: | :----: | :--------: |
| 20000  |   64   |     64     |



| 数据量 |               时间                | 模式 |
| :----: | :-------------------------------: | :-------------------------------: |
| 20000  | `[2.8620 ms 2.9052 ms 2.9500 ms]` |non-batch|
| 20000 | `[2.8255 ms 2.8635 ms 2.9047 ms]` |batch|

几乎没有优化，有点烦

那么2w的情况下，输入输出都对应着差不多的 bench 结果。

| 数据量 | 字段长 | Batch-Size |
| :----: | :----: | :--------: |
| 20000  |   64   |    256     |



|               时间                |   模式    |
| :-------------------------------: | :-------: |
| `[3.5098 ms 3.5602 ms 3.6087 ms]` | non-batch |
| `[3.1212 ms 3.1604 ms 3.2085 ms]` |   batch   |

这里有 12% 的优化。

----

## 第一次测试 - 2

运行一圈之后，发现大部分只有 0.1ms 的提升，感觉无法增加性能。

再运行一次，看到：



| 数据量 | 字段长 | Batch-Size |
| :----: | :----: | :--------: |
| 20000  |   64   |     64     |



| 数据量 |               时间                |   模式    |
| :----: | :-------------------------------: | :-------: |
| 20000  | `[3.9330 ms 4.0838 ms 4.2512 ms]` | non-batch |
| 20000  | `[3.5408 ms 3.7163 ms 3.9218 ms]` |   batch   |

----



| 数据量 | 字段长 | Batch-Size |
| :----: | :----: | :--------: |
| 20000  |  128   |     64     |



| 数据量 |               时间                |   模式    |
| :----: | :-------------------------------: | :-------: |
| 20000  | `[4.3269 ms 4.5532 ms 4.7914 ms]` | non-batch |
| 20000  | `[2.7901 ms 2.8149 ms 2.8426 ms]` |   batch   |





| 数据量 | 字段长 | Batch-Size |
| :----: | :----: | :--------: |
| 20000  |  128   |     64     |



| 数据量 |               时间                |   模式    |
| :----: | :-------------------------------: | :-------: |
| 20000  | `[3.0232 ms 3.0596 ms 3.0963 ms]` | non-batch |
| 20000  | `[2.5598 ms 2.5891 ms 2.6238 ms]` |   batch   |



预测结果：我需要记录数据